\documentclass[preprint]{iacrtrans}
\usepackage[utf8]{inputenc}

% Select what to do with todonotes: 
% \usepackage[disable]{todonotes} % notes not showed
\usepackage[draft,color=orange!20!white,linecolor=orange,textwidth=3cm,colorinlistoftodos]{todonotes}   % notes showed
\setlength{\marginparwidth}{3cm}
\usepackage{graphicx}
\usepackage{soul}
\graphicspath{{images/}} % end dirs with `/'
% \usepackage{longtable}
\usepackage{tikz}
\usetikzlibrary{arrows}
\usetikzlibrary{arrows.meta}
\usetikzlibrary{positioning}
\usetikzlibrary{calc}
\usetikzlibrary{backgrounds}
\usetikzlibrary{arrows}
\usetikzlibrary{crypto.symbols}
\tikzset{shadows=no}        % Option: add shadows to XOR, ADD, etc.

\author{Ella Rose\inst{1}}
\institute{Paso Robles, CA \email{python_pride@protonmail.com}}
\title[\texttt Lattice Based Key Exchange]{\texttt Lattice Based Key Exchange}

\begin{document}

\maketitle

% use optional argument because the \LaTeX command breaks the PDF keywords
\keywords[Key Exchange]{Key Exchange}\todo{Keywords?}

\begin{abstract}
  We define an algorithm for performing a key exchange between two parties utilizing lattice based ideas. The algorithm makes use of a small number of bignum multiplications and additions and is conceptually simple.\\ 
\end{abstract}

\todototoc
\listoftodos

\section{Introduction}
 The ability to exchange cryptographic keys over insecure channels is of vital importance to the function of the internet; Without algorithms for arranging secure communication online, much of every day life in the modern world would cease to be possible.\\

The introduction of Quantum Computing and post-quantum cryptography has lead to the development of lattice based cryptographic schemes that are believed to be secure even when faced with quantum parallelism. Simply put, RSA and DH will need replacement at some point, and lattices seem like a promising alternative.

Lattices are also very attractive because they offer homomorphic properties, which is another of the most important topics in cryptography at the moment. This property is also extremely important because it allows for the construction of simple public key encryption schemes and key exchange shemes from secret key ciphers. We present such a scheme in this paper, as well as a homomorphic cipher suitable for instantiating the scheme.

\section{Definitions}
We use $+$ to denote addition, $ab$ to denote multiplication, and $\mod p$ to denote the modulo operation.

\section{Algorithm}
First, we shall define the key exchange algorithm; Then, we shall define a secret key cipher suitable for instantiating the key exchange algorithm.

\subsection{Key Exchange Algorithm}
Let $p_1$ and $p_2$ be two encryptions of $0$ under the homomorphic secret key cipher. These two values constitute a public key. To share a secret with the owner of the public key, compute:
\begin{align}
    e \gets secret \\
    c \gets (p_1  r_1) + (p_2 r_2) + e
\end{align}

Where $r_1$ and $r_2$ are randomly generated values of appropriate size.\todo{What sizes are appropriate?} Then the value $c$ is shared with the owner of the public key. The owner of the public key can recover $e$ by applying the homomorphic decryption operation of the secret key cipher to c; This is because $p_1$ is an encryption of $0$, $p_1 r_1$ is equivalent to $0 r_1 \equiv 0$, similar for $p_2$. So when the decryption operation is applied, the result is $0 + 0 + e \equiv e$.

\subsection{Secret Key Cipher}
Creation of the $p_1$ and $p_2$ values requires a secure, additively homomorphic cipher. We define a simple lattice based cipher which utilizes effectively the same operations as the key exchange process. Let $s_1$ and $s_2$ be two large numbers, where $log_2(s_1) >= log_2(s_2) * 3$; These two numbers constitute the secret key for the cipher, which in turn acts as the private key for the key exchange presented previously.\\

To encrypt a ciphertext, compute:

\begin{align}
   c \gets (s_1 r_1) + (s_2 r_2) + m
\end{align}

Where the $r$ values are of appropriate size relative to $s_1$ and $s_2$ \todo{what sizes are appropriate}
While decryption is computed as:

\begin{align}
    m \gets (c \mod s_1) \mod s_2
\end{align}

\subsection{Note}
While the decryption circuit works via two modulo operations of the base points of the lattice, this operation does not work for the public key/key exchange portion of the algorithm - The reason is because in the secret key cipher, the two different lattice points are of largely different size; In the key exchange algorithm, both points are roughly the same size, and so the double modulo operation does not function identically.

\section{Conclusion}
 We define a simple lattice based key exchange algorithm. The algorithm utilizes 4 bignum multiplications and 4 bignum additions to generate a keypair, 2 bignum multiplications and 2 bignum additions per key sent, and 2 modulo operations on bignums to receive a key. Public keys occupy < 1200 bits using current parameter cohices, while private keys require about 600 bits.
\end{document}

